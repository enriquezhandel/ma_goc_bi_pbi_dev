{
  "properties": {
    "activities": [
      {
        "type": "Copy",
        "typeProperties": {
          "source": {
            "type": "DelimitedTextSource",
            "formatSettings": {
              "type": "DelimitedTextReadSettings",
              "skipLineCount": 0
            },
            "storeSettings": {
              "type": "LakehouseReadSettings",
              "recursive": true,
              "enablePartitionDiscovery": false
            },
            "datasetSettings": {
              "type": "DelimitedText",
              "typeProperties": {
                "location": {
                  "type": "LakehouseLocation",
                  "folderPath": "ad-hocOnly/PerfomanceComparison"
                },
                "columnDelimiter": ",",
                "quoteChar": "\"",
                "escapeChar": "\\",
                "firstRowAsHeader": true
              },
              "schema": [],
              "linkedService": {
                "name": "gocDEVBI",
                "properties": {
                  "type": "Lakehouse",
                  "typeProperties": {
                    "artifactId": "845ae521-8d6f-44d5-8a86-4eee09de35ea",
                    "workspaceId": "aedd58a1-3fc3-4d18-b48d-a8d0953254bf",
                    "rootFolder": "Files"
                  },
                  "annotations": []
                }
              },
              "annotations": []
            }
          },
          "sink": {
            "type": "DelimitedTextSink",
            "formatSettings": {
              "type": "DelimitedTextWriteSettings",
              "quoteAllText": true,
              "fileExtension": ".txt"
            },
            "storeSettings": {
              "type": "FileServerWriteSettings",
              "copyBehavior": "MergeFiles"
            },
            "datasetSettings": {
              "type": "DelimitedText",
              "typeProperties": {
                "location": {
                  "type": "FileServerLocation",
                  "folderPath": "test",
                  "fileName": "perfomanceComparison.csv"
                },
                "columnDelimiter": ",",
                "quoteChar": "\"",
                "escapeChar": "\\",
                "firstRowAsHeader": true
              },
              "schema": [],
              "externalReferences": {
                "connection": "66c04928-dd77-48ce-a6db-51218b1072ea"
              },
              "annotations": []
            }
          },
          "translator": {
            "type": "TabularTranslator",
            "typeConversion": true,
            "typeConversionSettings": {
              "allowDataTruncation": true,
              "treatBooleanAsNumber": false
            }
          },
          "enableStaging": false
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "ad_hocExtraction",
        "state": "Inactive",
        "onInactiveMarkAs": "Succeeded",
        "dependsOn": []
      },
      {
        "type": "Copy",
        "typeProperties": {
          "source": {
            "type": "SqlServerSource",
            "sqlReaderQuery": "Select \r\n\tCAST(requestedOn AS DATE) AS snapshot_date\r\n    ,ProductId\r\n    ,count(*) as 'nr tasks'\r\n    ,avg(CAST(DATEDIFF(second, startedOn, finishedon) as bigint)) as 'avg duration(s)'\r\n    ,sum(CAST(DATEDIFF(second, startedOn, finishedon) as bigint)) as 'max duration(s)'  \r\n    ,avg(CAST(DATEDIFF(second, RequestedOn, startedOn) as bigint)) as 'average wait(s)'  \r\n    ,sum(CAST(DATEDIFF(second, RequestedOn, startedOn) as bigint)) as 'max wait(s)'\r\n\t,sum(CAST(DATEDIFF(second, RequestedOn, startedOn) as bigint))/60 as 'max wait(m)'\r\nFROM [CatalystMVC].[dbo].[RiskAssessments] with (nolock)\r\nwhere requestedOn > '2024-9-01 00:00:00.00'\r\nand requestedOn < '2024-11-03 00:00:00.00'\r\nand productid=171\r\nand tasktype = 0\r\ngroup by datepart(Day, requestedOn),CAST(requestedOn AS DATE),ProductID\r\norder by 1, 2, 3",
            "partitionOption": "None",
            "datasetSettings": {
              "type": "SqlServerTable",
              "typeProperties": {
                "database": "CatalystMVC"
              },
              "schema": [],
              "externalReferences": {
                "connection": "8ac22d1d-f17f-402b-8299-b8c5f4ee5a17"
              },
              "annotations": []
            }
          },
          "sink": {
            "type": "DelimitedTextSink",
            "formatSettings": {
              "type": "DelimitedTextWriteSettings",
              "quoteAllText": true,
              "fileExtension": ".txt"
            },
            "storeSettings": {
              "type": "LakehouseWriteSettings"
            },
            "datasetSettings": {
              "type": "DelimitedText",
              "typeProperties": {
                "location": {
                  "type": "LakehouseLocation",
                  "folderPath": "ad-hocOnly",
                  "fileName": "riskAssestment"
                },
                "columnDelimiter": ",",
                "quoteChar": "\"",
                "escapeChar": "\\",
                "firstRowAsHeader": true
              },
              "schema": [],
              "linkedService": {
                "name": "gocDEVBI",
                "properties": {
                  "type": "Lakehouse",
                  "typeProperties": {
                    "artifactId": "307b753c-bf1d-4f1a-99be-6b8dc2916608",
                    "workspaceId": "00000000-0000-0000-0000-000000000000",
                    "rootFolder": "Files"
                  },
                  "annotations": []
                }
              },
              "annotations": []
            }
          },
          "translator": {
            "type": "TabularTranslator",
            "typeConversion": true,
            "typeConversionSettings": {
              "allowDataTruncation": true,
              "treatBooleanAsNumber": false
            }
          },
          "enableStaging": false
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Copy_2su",
        "dependsOn": []
      },
      {
        "type": "Copy",
        "typeProperties": {
          "source": {
            "type": "DelimitedTextSource",
            "formatSettings": {
              "type": "DelimitedTextReadSettings",
              "skipLineCount": 0
            },
            "storeSettings": {
              "type": "LakehouseReadSettings",
              "recursive": true,
              "enablePartitionDiscovery": false
            },
            "datasetSettings": {
              "type": "DelimitedText",
              "typeProperties": {
                "location": {
                  "type": "LakehouseLocation",
                  "folderPath": "ad-hocOnly",
                  "fileName": "riskAssestment"
                },
                "columnDelimiter": ",",
                "quoteChar": "\"",
                "escapeChar": "\\",
                "firstRowAsHeader": true
              },
              "schema": [],
              "linkedService": {
                "name": "gocDEVBI",
                "properties": {
                  "type": "Lakehouse",
                  "typeProperties": {
                    "artifactId": "307b753c-bf1d-4f1a-99be-6b8dc2916608",
                    "workspaceId": "00000000-0000-0000-0000-000000000000",
                    "rootFolder": "Files"
                  },
                  "annotations": []
                }
              },
              "annotations": []
            }
          },
          "sink": {
            "type": "DelimitedTextSink",
            "formatSettings": {
              "type": "DelimitedTextWriteSettings",
              "quoteAllText": true,
              "fileExtension": ".txt"
            },
            "storeSettings": {
              "type": "FileServerWriteSettings",
              "copyBehavior": "MergeFiles"
            },
            "datasetSettings": {
              "type": "DelimitedText",
              "typeProperties": {
                "location": {
                  "type": "FileServerLocation",
                  "fileName": "riskAssestmentDeck.csv"
                },
                "columnDelimiter": ",",
                "quoteChar": "\"",
                "escapeChar": "\\",
                "firstRowAsHeader": true
              },
              "schema": [],
              "externalReferences": {
                "connection": "66c04928-dd77-48ce-a6db-51218b1072ea"
              },
              "annotations": []
            }
          },
          "translator": {
            "type": "TabularTranslator",
            "typeConversion": true,
            "typeConversionSettings": {
              "allowDataTruncation": true,
              "treatBooleanAsNumber": false
            }
          },
          "enableStaging": false
        },
        "policy": {
          "timeout": "0.12:00:00",
          "retry": 0,
          "retryIntervalInSeconds": 30,
          "secureInput": false,
          "secureOutput": false
        },
        "name": "Copy_tmt",
        "dependsOn": [
          {
            "activity": "Copy_2su",
            "dependencyConditions": [
              "Succeeded"
            ]
          }
        ]
      }
    ]
  }
}